<!doctype html>
<html lang="ru">

<head>
	<meta charset="utf-8">
	<title>Files</title>
	<meta name="description" content="files">
	<meta name="keywords" content="files">
	<meta name="author" content="Edward & Albert">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<link rel="stylesheet" href="../../css/bundle.min.css">
	<!--[if lt IE 9]>
		<script src="../../js/html5shiv.min.js"></script>
	<![endif]-->
</head>

<body>
	<div class="reveal">
		<div class="slides">
			<section>
                <section>
                    <h1>Основы алгоритмизации и программирования</h1>
                    <h3>Работа с файлами</h3>
                    <p>
                        <small>Edward &amp; Albert / <a href="https://github.com/tgjmjgj/Clecture/">github:Tgjmjgj</a></small>
                    </p>
                </section>
				<section>
					<h2>Содержание лекции</h2>
					<nav id="presentable-toc" class="table-content"></nav>
				</section>
			</section>
            <section>
                <h1>Файловый ввод/вывод</h1>
                <blockquote>
                    Файловый ввод/вывод, как и консольный, бывает двух видов:
                </blockquote>
                <ul>
                    <li>Функциональный ввод/вывод (из C)</li>
                    <li>Потоковый ввод/вывод (C++)</li>
                </ul>
            </section>
            <section>
                <section>
                    <h1>Файл - что за фрукт</h1>
                    <blockquote>
                        <i>Файл</i> - это именованный объект, хранящий данные (программа или любая другая информация) на каком-либо
                        носителе (винчестер, CD). Файл, как и массив, - это совокупность данных, потому они немного похожи.
                    </blockquote>
                </section>
                <section>
                    <h2>Отличия файла от массива</h2>
                    <ul>
                        <li>Файлы хранятся не в оперативной памяти, а на внутреннем или внешнем носителе (как правило)</li>
                        <li>Файл не имеет фиксированной длины, т.е. может увеличиваться и уменьшаться сколько угодно</li>
                        <li>Перед работой с файлом его необходимо открыть, а в конце - закрыть</li>
                    </ul>
                </section>
                <section>
                    <h3>Тексторые и бинарные файлы</h3>
                    <blockquote>
                        Грубо говоря, файлы можно разделить на две категории:
                    </blockquote>
                    <ul>
                        <li>Текстовые файлы могут быть просмотрены и отредактированы с клавиатуры любым текстовым редакторов и 
                        имеют простую структуру: последовательность ASCII-символов. </li>
                        <li>Бинарные файлы – это файлы, которые не имеют  структуры текстовых файлов и хранят последовательность бит. 
                        Каждая программа для своих бинарных файлов определяет собственную структуру, т.е. чтение таких файлов
                        может оказаться весьма затруднительным.</li>
                    </ul>
                </section>
                <section>
                    <h2>Файлы в C</h2>
                    <blockquote>
                        Все файлы в С рассматриваются как неструктурированная последовательность байтов. Каждый файл
                        завершается маркером конца файла (end-of-file, EOF).
                    </blockquote>
                    <blockquote>
                        Когда файл открывается, то создается программный объект и с этим объектом связывается поток. 
                        Поток – это файл вместе с предоставленными средствами буферизации. Потоки можно открывать и 
                        закрывать (связывать указатели на поток с конкретными файлами); вводить и выводить строку, символ, 
                        форматированные данные, порцию данных произвольной длины; анализировать ошибки ввода/вывода и достижения конца файла; 
                        управлять буферизацией потока и размером буфера; получать и устанавливать указатель текущей позиции в файле.
                    </blockquote>
                </section>
            </section>
            <section>
                <section>
                    <h1>Файловый ввод/вывод С</h1>
                    <blockquote>
                        Функции файлового ввода/вывода С содержатся в той же библиотеке, где и функции для консольного ввода/вывода - <i>stdio.h</i>
                    </blockquote>
                </section>
                <section>
                    <h3>Функции для работы с файлами</h3>
                    <img src="img/stdio.h.jpg" />
                </section>
                <section>
                    <h3>Функции для работы с файлами 2</h3>
                    <img src="img/stdio.h-2.jpg" />
                </section>
            </section>
            <section>
                <section>
                    <h1>Начало работы с файлом</h1>
                    <blockquote>
                        Прежде чем начать работать с файлом, надо инициировать (открыть) поток. При этом поток связывается со структурой предопределенного типа FILE, 
                        который описан в библиотечном файле &lt;stdio.h&gt;. Объект этой структуры часто называют дескриптором файла.
                    </blockquote>
                    <blockquote>
                        В конце работы с файлом, тот же поток необходимо будет закрыть.
                    </blockquote>
                </section>
                <section>
                    <h1>Открытие файла</h1>
                    <blockquote>
                        Для открытия файла используется функция <i>fopen</i>.
                    </blockquote>
                    <pre>
                        <code class="cpp">
FILE* fopen(char* filename, char* mode);
                        </code>
                    </pre>
                    <blockquote>
                        При успешном открытии возвращает указатель на структуру типа FILE - указатель на файл. Эта структура 
                        связана с физическим файлом и используется для всех последующих операций над этим файлом.
                    </blockquote>
                </section>
                <section>
                    <h2>Имя файла</h2>
                    <blockquote>
                        Первый параметр функции <i>fopen</i> - <i>filename</i> служит для передачи имени файла, например
                        "D:\\Work\gifts\shared\нажми_меня.bat".
                    </blockquote>
                    <h3>Замечание!</h3>
                    <blockquote>
                        Поскольку символ обратного слеша \ в языках C/C++ используется для описания спец.символов ('\0','\n','\r'),
                        для записи конкретно обратного слеша используется конструкция из двух знаков: \\.
                        Это нужно учитывать при написании пути к файлу.
                    </blockquote>
                </section>
                <section>
                    <h2>Режимы открытия файла</h2>
                    <table>
                        <tr>
                            <td>Режим</td>
                            <td>Описание</td>
                        </tr>
                        <tr>
                            <td>"w"</td>
                            <td>Открыть файл для записи, если файл существует, то он стирается</td>
                        </tr>
                        <tr>
                            <td>"r"</td>
                            <td>Открыть файл для чтения</td>
                        </tr>
                        <tr>
                            <td>"a"</td>
                            <td>Открыть файл для добавления в конец, если файла нет, то он создается</td>
                        </tr>
                        <tr>
                            <td>"w+"</td>
                            <td>Открыть файл для записи, чтения, исправления. Если файл существует, он стирается</td>
                        </tr>
                        <tr>
                            <td>"r+"</td>
                            <td>Открыть файл для чтения и исправления, однако нельзя увеличивать размер файла</td>
                        </tr>
                        <tr>
                            <td>"a+"</td>
                            <td>Открыть файл для добавления. Как режим "w+", только существующий файл не стирается</td>
                        </tr>
                        <tr>
                            <td>"t"</td>
                            <td>Файл открывается в текстовом режиме (по умолчанию)</td>
                        </tr>
                        <tr>
                            <td>"b"</td>
                            <td>Файл открывается в бинарном режиме</td>
                        </tr>
                    </table>
                </section>
                <section>
                    <ul>
                        <li>
                            Режимы с <i>"w"</i> - создается пустой новый файл. Старый удаляется.
                        </li>
                        <li>
                            Режимы с <i>"r"</i> - индикатор позиции на начало файла, если файл не существует - неудача.
                        </li>
                        <li>
                            Режимы с <i>"a"</i> - индикатор позиции на конец файла, если файл не сущестует - создается новый.
                        </li>
                    </ul>
                </section>
                <section>
                    <h3>Пример открытия файла</h3>
                    <pre>
                        <code class="cpp">
FILE* f;
f = fopen("D:\\programs\explos\init.txt", "tr+");
FILE *fl = fopen("C:\\pagefile.sys", "bw");
                        </code>
                    </pre>
                </section>
            </section>
            <section>
                <h1>Закрытие файла</h1>
                <blockquote>
                    После работы с файлом он должен быть закрыт. Для закрытия файла используется функция <i>fclose</i>
                </blockquote>
                <pre>
                    <code class="cpp">
                        int fclose(FILE* file);
                    </code>
                </pre>
                <blockquote>
                    Функции <i>fclose</i> передается дескриптор файла, который необходимо закрыть.
                </blockquote>
                <blockquote>
                    Если файл не был закрыт в программном коде, система автоматически закроет его при заверщении работы программы.
                </blockquote>
            </section>
            <section>
                <h2>Закрытие всех файлов</h2>
                <blockquote>
                    Для закрытия всех ранее открытых файлов используется функция <i>fcloseall</i>
                </blockquote>
                <pre>
                    <code>
int fcloseall(void);            
                    </code>
                </pre>
                <blockquote>
                    При успешном завершении возвращает количество закрытых потоков.
                </blockquote>
            </section>
            <section>
                <h2>Пример обращения к файлу</h2>
                <pre>
                    <code class="cpp">
FILE *fp;
if ((fp = fopen("file.txt", "w")) == NULL)
{
    perror("\nОшибка при открытии файла");  // Выведет сообщение об ошибке
    exit(0);
}
...
fclose(fp);
                    </code>
                </pre>
            </section>
            <section>
                <h2>Функция перенаправления потока</h2>
                <blockquote>
                    Если требуется изменить режим доступа к файлу, то для этого сначала необходимо закрыть данный файл, 
                    а затем вновь его открыть, но с другими правами доступа. Для этого уже существует стандартная функция:
                </blockquote>
                <pre>
                    <code class="cpp">
FILE* freopen(char* filename, char* mode, FILE* handle);
                    </code>
                </pre>
                <blockquote>
                    Эта функция сначала закрывает файл, связанный с дескриптором <i>handle</i>, а затем открывает файл с 
                    именем файла <i>filename</i> и правами доступа <i>mode</i>.
                </blockquote>
            </section>
            <section>
                <h1>Индикатор конца файла</h1>
                <blockquote>
                    Структура <i>FILE</i> содержит индикатор конца файла, который имеет значение 0, пока конец файла не достигнут.
                    Индикатор конца файла перепроверяется после каждой операции чтения.
                </blockquote>
                <blockquote>
                    Состояние конца файла можно получить используя функцию <i>feof</i>.
                </blockquote>
                <pre>
                    <code class="cpp">
int feof(FILE *f);
                    </code>
                </pre>
                <blockquote>
                    Эта функция возвращает ненулевое значение, если индикатор конца файла установлен, в противном случае возвращается 0.
                </blockquote>
            </section>
            <section>
                <h1>Чтение/запись из файла</h1>
                    Операции по чтению/записи данных из файла можно разделить на три группы:
                <blockquote>
                    <ul>
                        <li>Посимвольный ввод/вывод</li>
                        <li>Построчный ввод/вывод</li>
                        <li>Блочный ввод/вывод</li>
                    </ul>
                </blockquote>
            </section>





            </div>
        </div>
	<aside id="presentable-icon" class="cpp">
		<a title="Содержание лекции" href="#/0/1">
			<i class="fa fa-list-ul fa-2x"></i>
		</a>
	</aside>
	<script src="../../js/bundle.min.js"></script>
</body>

</html>